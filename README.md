# Teaching of Geography · 地理课堂教学工具

基于 Three.js + React + Vite 的交互式地球课堂演示工具，用于**地理课堂教学 / 学生自主探索 / 课后复习**。

- 真实三维地球（贴图 + 国界线），支持旋转 / 缩放 / 点击选点
- 课堂模式：自由探索 / 板块构造 / 世界气候 / 人文地理
- 任务系统：每节课 6 条任务，自动判定完成并加分，带奖励弹窗
- AI 讲解：按课程主题和“简要 / 详细”两档生成课堂讲解
- 课堂笔记：收藏当前讲解，一键回放并自动转到对应地点
- 手势控制（可选）：单手挥动控制旋转，张开 / 握拳控制缩放

---

## 一、快速体验

### 本地运行（推荐）

```bash
# 克隆仓库
git clone git@github.com:andic1/Teaching-of-Geography.git
cd Teaching-of-Geography

# 安装依赖
npm install

# 启动开发服务器
npm run dev
```

终端会输出本地访问地址，例如：

```text
Local:   http://localhost:5173/
Network: http://192.168.xx.xx:5173/
```

浏览器打开地址即可进入**启动页**。

> 首次进入建议老师先点击「查看操作指引」，用 1 分钟向学生说明基本操作。

### 生产构建

```bash
npm run build
npm run preview   # 可选，本地预览打包结果
```

打包产物位于 `dist/` 目录，可部署到任意静态站点服务（GitHub Pages / Vercel / Netlify 等）。

---

## 二、课堂使用流程

### 1. 启动与基础操作

- **拖动地球**：按住鼠标左键在地球上拖动，旋转视角。
- **滚轮缩放**：滚轮向前拉近、向后推远镜头。
- **点击选点**：在地球表面任意位置单击，系统会锁定该点经纬度并生成一条“课堂讲解”。

### 2. 选择课程模式

左上角可切换 4 种模式：

- 自由探索
- 板块构造课
- 世界气候课
- 人文地理课

不同模式会影响：

- AI 讲解的角度与侧重点
- 右侧“课堂任务”列表的题目内容

### 3. 讲解深度：简要 / 详细

左上“讲解深度”支持两档：

- **简要**：适合低年级或快速浏览，用于课堂导入 / 热身
- **详细**：适合高年级或复习巩固，包含更多背景信息

AI 讲解在生成前会根据当前模式与深度调节 Prompt，保证内容贴合教学目标。

### 4. 课堂任务与积分

右侧“课堂任务”面板：

- 每节课自动抽取 6 条任务
- 当前任务在列表中高亮
- 学生根据提示在地球上选点，系统自动判断是否达成
- 完成任务会：
  - 标记为已完成 ✓
  - 弹出奖励弹窗
  - 增加总积分

老师可以：

1. 先让学生阅读任务描述
2. 组织学生讨论应点击的区域
3. 由一名学生上台操作地球
4. 用奖励分数提升课堂参与度

### 5. 课堂笔记与回放

左下方“课堂讲解”卡片右上有 **收藏** 按钮：

- 点击后会将 **地点 + 讲解内容 + 所属课程 + 时间戳** 保存为一条课堂笔记
- 右侧“课堂笔记”列表中点击任一条：
  - 地球会自动平滑旋转到对应位置
  - 左下卡片回放当时的讲解

适用场景：

- 老师课前准备“重点区域清单”，按顺序回放讲解
- 复习课上快速回顾重要案例（火山带、季风区、人口密集区等）

### 6. 手势控制（可选）

右下角“手势控制”面板显示为 **在线** 时，可启用手势：

- 将一只手放入摄像头画面中心
- 左右挥动手掌：地球左右旋转
- 上下挥动：微调俯仰角度
- 在手基本不移动时，缓慢张开 / 握拳：控制缩放

> 如果教室设备条件有限（无摄像头或带宽不足），所有操作均可只用鼠标完成。

---

## 三、技术栈

- **前端框架**：React + TypeScript + Vite
- **3D 渲染**：Three.js（自定义球体、纹理、网格与交互射线检测）
- **样式**：Tailwind CSS，自定义浅色教学主题
- **AI 接口**：兼容 OpenAI 风格的 Chat Completions API（示例中使用 Qwen 模型）

项目结构简要：

- `App.tsx`：应用入口，管理教学模式 / 任务 / 讲解 / 收藏等状态
- `components/HoloEarth.tsx`：Three.js 地球渲染与交互
- `components/HoloUI.tsx`：顶部课程选择、任务面板、讲解卡片、收藏列表
- `components/HandPanel.tsx`：摄像头 + MediaPipe 手势识别
- `services/geminiService.ts`：AI 接口封装与缓存

---

## 四、比赛 / 展示建议流程

1. 打开启动页，先点击「查看操作指引」，向评委简要说明使用方式。
2. 进入课堂后：
   1. 选择一个课程模式（如“世界气候课”）。
   2. 让评委看右侧任务列表，并选定一条任务。
   3. 通过拖动地球 + 点击选点完成任务，触发奖励弹窗。
   4. 展示“简要 / 详细”两档讲解的区别。
   5. 收藏 1–2 条讲解，然后在课堂笔记中点选回放，演示地球自动对准功能。
3. 如条件允许，再演示一次手势控制，为项目加一点互动亮点。

---

## 五、注意事项

- 项目包含一张大尺寸离线卫星贴图：`public/textures/earth_satellite_8k.jpg`，约 60MB。
  - 如需减小仓库体积，可自行替换为更小的贴图，或使用 Git LFS 管理。
- AI 接口需要配置环境变量（示例）：

```bash
VITE_QWEN_BASE_URL=...
VITE_QWEN_API_KEY=...
VITE_QWEN_MODEL=qwen2-7b-instruct
```

将其写入 `.env.local` 并保证不会提交到公共仓库。

